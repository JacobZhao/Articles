# 光模块测试 #
## 一、眼图测试 ##

**1.主要测量指标**

- Average Power
- ER
- Mask Margin
- JitterPP
- JitterRMS
- Crossing

![](https://i.imgur.com/7Dyfo2v.gif)

**2.眼图的形成**

实际中，描述串行数据的常用单位是波特率和 UI，串行数据传输示例如下：

例如，比特率为 3.125Gb/s 的信号表示为每秒传送的数据比特位是 3.125G 比特，对应 的一个单位间隔即为 1UI。1UI表示一个比特位的宽度，它是波特率的倒数，即 1UI=1/（3.125Gb/s）=320ps。现在比较常见的串行信号码形是 NRZ 码，因此在一般的情况下对 于串行数据信号，我们的工作均是针对 NRZ 码进行的（后面再介绍NRZ编码）。

![](https://i.imgur.com/MbfdwvY.jpg)

眼图，是由于示波器的余辉作用，将扫描所得的每一个码元波形重叠在一起，从而形成眼图。眼图中包含了丰富的信息，从眼图上可以观察出码间串扰和噪声的影响，体现了 数字信号整体的特征，从而可以估计系统优劣程度，因而眼图分析是高速互连系统信号完 整性分析的核心。

对于数字信号，其高电平与低电平的变化可以有多种序列组合。以3个bit为例，可以有000-111共8中组合，在时域上将足够多的上述序列按某一个基准点对齐，然后将其波形叠加起来，就形成了眼图。如图。对于测试仪器而言，首先从待测信号中恢复出信号的时钟信号，然后按照时钟基准来叠加出眼图，最终予以显示。

![](https://i.imgur.com/F1LAQpE.jpg)

![](https://i.imgur.com/mLeHvFG.jpg)

**3.平均光功率average power**

平均发射光功率是光发射机最重要的技术指标，它是指在“0”“1”码等概率调制的情况下，光发射机输出的光功率值，单位为W或dBm。一般情况下，光发射机的平均发光功率越大越好。因为其值越大，进入光纤进行有效传输的光功率越大，其中继距离越长。但其值也不能过大，否则会降低光源器件的寿命。

单位：dBm,mW 两者换算关系：(0)dBm=10log(1)mW

![](https://i.imgur.com/p2hSbmk.jpg)

	dB 是一个纯计数单位：对于功率，dB = 10*lg(A/B）。对于电压或电流，dB = 20*lg(A/B)。
dBm是一个考征功率绝对值的值，计算公式为：10lg（功率值/1mw）。标准是： 0 dBm=10log1 mw； 3dBm=10log 2mw。简单的记作：30是基准，等于1W整，加3乘以2，加10乘以10；减 3除以2，减10除以10。

**4.消光比ExtinctionRatio**

消光比，是指激光器在发射全“1”码时的光功率P1与全“0”码时发射的光功率P0之比。

【光源消光比】是度量偏振相关器件（如保偏光纤、保偏光纤耦合器、偏振器）保持偏振态稳定性能的指标。当一束偏振光精确地沿保偏器件某一光轴入射时，在正交轴方向上会激发偏振模，两个正交轴上的功率比值就是光源的消光比。简称“消光比”。

![](https://i.imgur.com/4hMqssY.jpg)

消光比的大小决定通讯信号的品质，其值愈大，代表在接收机端会有愈好的逻辑鉴别率，但也不能过大，过大则引起啁啾声，频谱变宽，色散变大。值愈小，表示信号较易受杂讯的影响会使误码率上升。

**5.Mask Margin**

眼图将信号的上升时间、下降时间、脉冲过冲、脉冲下冲以及震荡等特性包含在里面，由四部分组成：常“1”电平，“1”电平，“0”电平，常“0”电平。测试的最低要求：不能有码点落在眼图模板内，否则经过一定的光纤衷减，在接收端很难分辨出码点是“1”还是“0”，从而产生误码。

![](https://i.imgur.com/vYD7EZe.jpg)

**6.抖动Jitter**

一个信号在跳变时，相对其理想位置的偏移量。

![](https://i.imgur.com/37gHnML.jpg)

	JitterPP: jitter peak to peak
	JitterRMS: 是jitter的均方根或标准偏差

![](https://i.imgur.com/MN8fBet.jpg)

**7.交叉比Crossing**

是测量交叉点振幅与信号“1”及“0”位准之关系，因此不同交叉比例关系可传递不同信号位准。一般标准的信号其交叉比为50%，即表示信号“1”及“0”各占一半的位准。为了测量其相关比率，使用如下图所示的统计方式。交叉位准是依据交叉点垂直统计的中心窗口而计算出来的平均值，其比例方程式如下（其中的1 及0 位准是取眼图中间的20%为其平均值，即从40%~60%中作换算）：

![](https://i.imgur.com/JxTUTTZ.jpg)

## 二、误码测试 ##

**1.PRBS伪随机二进制序列**


PRBS是Pseudo Random Binary Sequence的缩写，即“伪随机二进制序列”的意思。PRBS码具有“随机”特性，是因为在PRBS码流中，二进制数“0”和“1”是随机出现的，但是它又和真正意义上的随机码不同，这种“随机”特性只是局部的，即在周期内部，“0”和“1”是随机出现的(码流生成函数与初始码确定后，码流的顺序也是固定的)，但各个周期中的码流却是完全相同的，所以我们称其为“”伪随机码。

PRBS码的周期长度与其阶数有关，常用的阶数有7、9、11、15、20、23、31，也就是我们常说的PRBS7、PRBS9、PRBS11、PRBS15、PRBS20、PRBS23、PRBS31。

对于n阶PRBS码，每个周期的序列长度为2^n-1，在每个周期内，“0”和“1”是随机分布的，并且“0”和“1”的个数相等，连“1”的最大数目为n，连“0”的最大数目为n-1(反转后就是n-1个连“1”和n个连“0”)。下图是常用阶数码流参数统计表：

![](https://i.imgur.com/Gjr0qYh.jpg)

在对高速信号链路进行误码测试时，基本上都是利用PRBS码流来模拟真实的线网码流环境，因为在线网中，所有的数据都是随机出现的，没有任何规律可言，而PRBS码流在一定程度上具有这种“随机数据”特性，二进制“0”和“1”随机出现，其频谱特征与白噪声非常接近。PRBS码流的阶数越高，其包含的码型就越丰富，就越接近真实的线网环境，测试的结果就越准确

**2.误码率**

误码率（BER：bit error rate）是衡量数据在规定时间内数据传输精确性的指标。

	误码率=传输中的误码/所传输的总码数*100%。


误码的产生是由于在信号传输中，衰变改变了信号的电压,致使信号在传输中遭到破坏，产生误码。噪音、交流电或闪电造成的脉冲、传输设备故障及其他因素都会导致误码（比如传送的信号是1，而接收到的是0；反之亦然）

这里跑的码，就是上面提到的PRBS31。

例：如果100G的QSFP28 SR4模块的误码率在1E-12级别，在理论情况下，某一个通道出现一个误码需要运行多久时间？

解：由公式得，需要传输的总码数位1E+12。而传输速率为100G，则每个通道为25G，那么需要运行是时间应该是：1E+12除以25G，等于40s。

**3.灵敏度**

达到规定误码率（如1E-12）时，所对应的接收光功率大小。测量方法有两种：

- 一种是直接测量，将接收光功率调到spec-9.5dBm以下，跑误码，如果此时误码率不大于1E-12，那么就满足spec。
- 一种是曲线拟合。由于直接测量时间长（至少40s），所以先测出1E-7、1E-8、1E-9、1E-10对应的接收光功率，然后曲线拟合，计算出1E-12对应的光功率值，即为灵敏度，如下图。

![](https://i.imgur.com/ZodbhPi.jpg)